<div class="card  bg-card bg-card mb-4">
    <div class="container p-2">
        <article class="media">
            <figure class="align-self-start">
                <p class="mr-3 image is-64x64">
                    <img src="data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2264%22%20height%3D%2264%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2064%2064%22%20preserveAspectRatio%3D%22none%22%3E%3Cdefs%3E%3Cstyle%20type%3D%22text%2Fcss%22%3E%23holder_174b1ede77f%20text%20%7B%20fill%3Argba(255%2C255%2C255%2C.75)%3Bfont-weight%3Anormal%3Bfont-family%3AHelvetica%2C%20monospace%3Bfont-size%3A10pt%20%7D%20%3C%2Fstyle%3E%3C%2Fdefs%3E%3Cg%20id%3D%22holder_174b1ede77f%22%3E%3Crect%20width%3D%2264%22%20height%3D%2264%22%20fill%3D%22%23777%22%3E%3C%2Frect%3E%3Cg%3E%3Ctext%20x%3D%2213%22%20y%3D%2236.5%22%3E64x64%3C%2Ftext%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E"
                        alt="64x64" style="width: 64px; height: 64px;" data-holder-rendered="true">
                </p>
            </figure>
            <div class="media-body">
                <%= render 'form'%>
            </div>
        </article>
    </div>
</div>

<div class="scrollfeed scrollbar-black bordered-black square thin ">
    <% @tweets.each do |tweet| %> 

        <% hayretweet2 = Retweet.where(username_id: current_user.username, tweet_id: tweet.id)%>
        <% hayretweet2.each do |hayretweet| %>  
            <% if hayretweet != nil %>
            <% tweetRetweet = Tweet.find_by(:id => hayretweet.tweet_id)%>
                <div class="card  bg-card mb-3">
                    <div class="container p-2">
                        <article class="media">
                            <div class="align-self-start">
                                <figure class=" mr-3 image is-64x64">
                                    <img src="data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2264%22%20height%3D%2264%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2064%2064%22%20preserveAspectRatio%3D%22none%22%3E%3Cdefs%3E%3Cstyle%20type%3D%22text%2Fcss%22%3E%23holder_174b1ede77f%20text%20%7B%20fill%3Argba(255%2C255%2C255%2C.75)%3Bfont-weight%3Anormal%3Bfont-family%3AHelvetica%2C%20monospace%3Bfont-size%3A10pt%20%7D%20%3C%2Fstyle%3E%3C%2Fdefs%3E%3Cg%20id%3D%22holder_174b1ede77f%22%3E%3Crect%20width%3D%2264%22%20height%3D%2264%22%20fill%3D%22%23777%22%3E%3C%2Frect%3E%3Cg%3E%3Ctext%20x%3D%2213%22%20y%3D%2236.5%22%3E64x64%3C%2Ftext%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E"
                                        alt="64x64" style="width: 64px; height: 64px;" data-holder-rendered="true">
                                </figure>

                            </div>
                            <div class="media-body">
                                <div class="mt-0 mb-1">
                                    <strong class="card-title">
                                    <%= link_to "#{hayretweet.username_id}", profile_path(hayretweet.username_id),class:"text-white" %>
                                    </strong><br />
                                    <p class="card-text">                            
                                        <%= hayretweet.tweet %>
                                        
                                    </p>                             
                                </div>
                                
                                
                                <div class = "p-0 m-0 pt-3">
                                    <div class="card bg-card-2 mb-4">
                                        <div class="container p-2">
                                            <article class="media">
                                                <div class="align-self-star">
                                                    <figure class="mr-3 image is-64x64">
                                                        <img src="data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2264%22%20height%3D%2264%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2064%2064%22%20preserveAspectRatio%3D%22none%22%3E%3Cdefs%3E%3Cstyle%20type%3D%22text%2Fcss%22%3E%23holder_174b1ede77f%20text%20%7B%20fill%3Argba(255%2C255%2C255%2C.75)%3Bfont-weight%3Anormal%3Bfont-family%3AHelvetica%2C%20monospace%3Bfont-size%3A10pt%20%7D%20%3C%2Fstyle%3E%3C%2Fdefs%3E%3Cg%20id%3D%22holder_174b1ede77f%22%3E%3Crect%20width%3D%2264%22%20height%3D%2264%22%20fill%3D%22%23777%22%3E%3C%2Frect%3E%3Cg%3E%3Ctext%20x%3D%2213%22%20y%3D%2236.5%22%3E64x64%3C%2Ftext%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E"
                                                            alt="64x64" style="width: 64px; height: 64px;" data-holder-rendered="true">
                                                    </figure>
                                                </div>
                                                <div class="media-body">
                                                    <div class="mt-0 mb-1">
                                                        <strong class="card-title">
                                                            <%= link_to "#{tweetRetweet.username}", profile_path(tweetRetweet.username),class:"text-white" %>
                                                        </strong><br />
                                                        <p class="card-text ">                                                        
                                                            <%= tweetRetweet.twittear %>
                                                        </p>
                                                    </div>
                                                </div>
                                                <nav class="level">
                                                    <div class="level-left is-mobile d-flex justify-content-start">
                                                        <% if user_signed_in? %>
                                                            <% yaLikeo = Like.where(username_id: current_user.username, tweet_id: tweet.id).count%>                                
                                                            <% if yaLikeo == 1%>
                                                                <div class = "pl-1">
                                                                    <% contLike = Like.where(tweet_id: tweet.id).count%>
                                                                    <%= contLike%>
                                                                </div>
                                                                <a class="level-item p-1" href="/like/<%=tweet.id%>" data-method="delete">                                          
                                                                    <svg width="1em" height="1em" class="bi bi-heart-fill p-0 m-0 pt-1" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                                                        <path fill-rule="evenodd" d="M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314z"/>
                                                                    </svg>
                                                                </a>
                                                            <% else %>
                                                                <a class="level-item p-1"  href="/like?id=<%=tweet.id%>" data-method="post">
                                                                    <svg width="1em" height="1em" class="bi bi-hearth p-0 m-0 pt-1" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                                                        <path fill-rule="evenodd" d="M8 2.748l-.717-.737C5.6.281 2.514.878 1.4 3.053c-.523 1.023-.641 2.5.314 4.385.92 1.815 2.834 3.989 6.286 6.357 3.452-2.368 5.365-4.542 6.286-6.357.955-1.886.838-3.362.314-4.385C13.486.878 10.4.28 8.717 2.01L8 2.748zM8 15C-7.333 4.868 3.279-3.04 7.824 1.143c.06.055.119.112.176.171a3.12 3.12 0 0 1 .176-.17C12.72-3.042 23.333 4.867 8 15z"/>
                                                                    </svg>
                                                                </a>
                                                            <% end %>                                
                                                        <% end %>
                                                    </div>
                                                <nav>
                                            </article>
                                        </div>
                                    </div>
                                </div> 


                                <nav class="level">
                                    <div class="level-left is-mobile d-flex justify-content-start">
                                        <%if hayretweet.username_id == current_user.username %>
                                            <%= form_with(url: hayretweet, method: "delete", class: "level-item p-1 pt-0 pl-2") do %>
                                                <%= button_tag('',class:'icon' , data: {confirm: "Are you sure?"}) do %>
                                                    <svg width="1em" height="1em" class="bi bi-trash-fill p-0 m-0 pt-1" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                                        <path fill-rule="evenodd" d="M2.5 1a1 1 0 0 0-1 1v1a1 1 0 0 0 1 1H3v9a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V4h.5a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1H2.5zm3 4a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 .5-.5zM8 5a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7A.5.5 0 0 1 8 5zm3 .5a.5.5 0 0 0-1 0v7a.5.5 0 0 0 1 0v-7z"/>
                                                    </svg>
                                                <% end %>
                                            <% end %>
                                        <%end%>            
                                    </div>
                                </nav>



                            </div>
                        </article>
                    </div>
                </div>
            <% end %>
        <% end %>
        


        <div class="card  bg-card mb-3">
            <div class="container p-2">
                <article class="media">
                    <div class="align-self-start">
                        <figure class=" mr-3 image is-64x64">
                            <img src="data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2264%22%20height%3D%2264%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2064%2064%22%20preserveAspectRatio%3D%22none%22%3E%3Cdefs%3E%3Cstyle%20type%3D%22text%2Fcss%22%3E%23holder_174b1ede77f%20text%20%7B%20fill%3Argba(255%2C255%2C255%2C.75)%3Bfont-weight%3Anormal%3Bfont-family%3AHelvetica%2C%20monospace%3Bfont-size%3A10pt%20%7D%20%3C%2Fstyle%3E%3C%2Fdefs%3E%3Cg%20id%3D%22holder_174b1ede77f%22%3E%3Crect%20width%3D%2264%22%20height%3D%2264%22%20fill%3D%22%23777%22%3E%3C%2Frect%3E%3Cg%3E%3Ctext%20x%3D%2213%22%20y%3D%2236.5%22%3E64x64%3C%2Ftext%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E"
                                alt="64x64" style="width: 64px; height: 64px;" data-holder-rendered="true">
                        </figure>
                    </div>
                    <div class="media-body">
                        <div class="mt-0 mb-1">
                            <strong class="card-title">
                                <%= link_to "#{tweet.username}", profile_path(tweet.username),class:"text-white" %>
                            </strong><br />
                            <p class="card-text">                            
                                <%= render_with_hashtags(tweet.twittear) %>
                            </p>                             
                        </div>
                        <nav class="level">
                            <div class="level-left is-mobile d-flex justify-content-start">
                                <% if user_signed_in? %>
                                    <div class = "pl-1 pr-1">
                                        <% contRetweet = Retweet.where(tweet_id: tweet.id).count%>
                                        <%= contRetweet%>
                                    </div>                      
                                    <a class="level-item pt-0 mt-0 pr-2"  onclick="mostrarformulario('formularioRetweet<%=tweet.id%>');">
                                        <svg width="18px" height="18px" viewBox="0 0 18 37" class="bi bi-reply-fill p-0 m-0" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                            <path d="M9.079 11.9l4.568-3.281a.719.719 0 0 0 0-1.238L9.079 4.1A.716.716 0 0 0 8 4.719V6c-1.5 0-6 0-7 8 2.5-4.5 7-4 7-4v1.281c0 .56.606.898 1.079.62z"></path>
                                        </svg>                                    
                                    </a>
                                    

                                    <div class = "pl-1">
                                        <% contComment = Comment.where(tweet_id: tweet.id).count%>
                                        <%= contComment%>
                                    </div>                        
                                    <% if contComment == 0%>
                                        <div class="align-self-start">
                                            <a class="level-item pt-0 mt-0 pl-1 pr-2"  onclick="mostrarformulario('formComment<%=tweet.id%>');">
                                                <svg width="18px" height="18px" viewBox="0 0 18 37" class="bi bi-chat-dots p-0 m-0" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                                    <path fill-rule="evenodd" d="M2.678 11.894a1 1 0 0 1 .287.801 10.97 10.97 0 0 1-.398 2c1.395-.323 2.247-.697 2.634-.893a1 1 0 0 1 .71-.074A8.06 8.06 0 0 0 8 14c3.996 0 7-2.807 7-6 0-3.192-3.004-6-7-6S1 4.808 1 8c0 1.468.617 2.83 1.678 3.894zm-.493 3.905a21.682 21.682 0 0 1-.713.129c-.2.032-.352-.176-.273-.362a9.68 9.68 0 0 0 .244-.637l.003-.01c.248-.72.45-1.548.524-2.319C.743 11.37 0 9.76 0 8c0-3.866 3.582-7 8-7s8 3.134 8 7-3.582 7-8 7a9.06 9.06 0 0 1-2.347-.306c-.52.263-1.639.742-3.468 1.105z"/>
                                                    <path d="M5 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm4 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm4 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"/>
                                                </svg>                                   
                                            </a>
                                        </div>                                       
                                    <% else %>
                                        <div class="align-self-start">
                                            <a class="level-item pt-0 mt-0 pl-1 pr-2"  onclick="mostrarformulario('formComment<%=tweet.id%>');">
                                                <svg width="18px" height="18px" viewBox="0 0 18 37" class="bi bi-chat-dots-fill p-0 m-0" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                                    <path fill-rule="evenodd" d="M16 8c0 3.866-3.582 7-8 7a9.06 9.06 0 0 1-2.347-.306c-.584.296-1.925.864-4.181 1.234-.2.032-.352-.176-.273-.362.354-.836.674-1.95.77-2.966C.744 11.37 0 9.76 0 8c0-3.866 3.582-7 8-7s8 3.134 8 7zM5 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm4 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm3 1a1 1 0 1 0 0-2 1 1 0 0 0 0 2z"/>
                                                </svg>                                    
                                            </a>
                                        </div>
                                    <% end %>


                                    <% yaLikeo = Like.where(username_id: current_user.username, tweet_id: tweet.id).count%>
                                    <div class = "pl-1">
                                        <% contLike = Like.where(tweet_id: tweet.id).count%>
                                        <%= contLike%>
                                    </div>                          
                                    <% if yaLikeo == 1%>
                                        <a class="level-item p-1" href="/like/<%=tweet.id%>" data-method="delete">                                          
                                            <svg width="1em" height="1em" class="bi bi-heart-fill p-0 m-0 pt-1" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                                <path fill-rule="evenodd" d="M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314z"/>
                                            </svg>
                                        </a>
                                    <% else %>
                                        <a class="level-item p-1"  href="/like?id=<%=tweet.id%>" data-method="post">
                                            <svg width="1em" height="1em" class="bi bi-hearth p-0 m-0 pt-1" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                                <path fill-rule="evenodd" d="M8 2.748l-.717-.737C5.6.281 2.514.878 1.4 3.053c-.523 1.023-.641 2.5.314 4.385.92 1.815 2.834 3.989 6.286 6.357 3.452-2.368 5.365-4.542 6.286-6.357.955-1.886.838-3.362.314-4.385C13.486.878 10.4.28 8.717 2.01L8 2.748zM8 15C-7.333 4.868 3.279-3.04 7.824 1.143c.06.055.119.112.176.171a3.12 3.12 0 0 1 .176-.17C12.72-3.042 23.333 4.867 8 15z"/>
                                            </svg>
                                        </a>
                                    <% end %>                                
                                <% end %>

                                <%if tweet.username== current_user.username %>
                                    <%= form_with(url: tweet, method: "delete", class: "level-item p-1 pt-0 pl-2") do %>
                                        <%= button_tag('',class:'icon' , data: {confirm: "Are you sure?"}) do %>
                                            <svg width="1em" height="1em" class="bi bi-trash-fill p-0 m-0 pt-1" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                                <path fill-rule="evenodd" d="M2.5 1a1 1 0 0 0-1 1v1a1 1 0 0 0 1 1H3v9a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V4h.5a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1H2.5zm3 4a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 .5-.5zM8 5a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7A.5.5 0 0 1 8 5zm3 .5a.5.5 0 0 0-1 0v7a.5.5 0 0 0 1 0v-7z"/>
                                            </svg>
                                        <% end %>
                                    <% end %>
                                <%end%>
                                
                            </div>                        
                            <div class ="pt-1" id ="formularioRetweet<%=tweet.id%>" style ="display: none;">
                                <%= render "retweet/retweet.html.erb", tweet_id: tweet.id%>  
                            </div>

                        <nav>
                    </div>
                </article>      
            </div>


            <div class ="pt-1" id ="formComment<%=tweet.id%>" style ="display: none;">
                <div class = "m-0 p-0">
                    <div class="card bg-card bg-card ">
                        <div class="container p-2">
                            <article class="media">                                        
                                <div class="media-body">
                                    <%= render "comment/formComment.html.erb", tweet_id: tweet.id%> 
                                </div>
                            </article>
                        </div>
                    </div>
                </div>

                <div class="container">
                    <div class="scrollWhoFollow scrollbar-black bordered-black square thin ">
                    <% hayComment2 = Comment.where(tweet_id: tweet.id)%>
                        <% hayComment2.each do |hayComment| %> 
                            <div class="card bg-card-2 mb-4">
                                <div class="container p-2">
                                    <article class="media">
                                        <div class="align-self-star">
                                            <figure class="mr-3 image is-64x64">
                                                <img src="data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2264%22%20height%3D%2264%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2064%2064%22%20preserveAspectRatio%3D%22none%22%3E%3Cdefs%3E%3Cstyle%20type%3D%22text%2Fcss%22%3E%23holder_174b1ede77f%20text%20%7B%20fill%3Argba(255%2C255%2C255%2C.75)%3Bfont-weight%3Anormal%3Bfont-family%3AHelvetica%2C%20monospace%3Bfont-size%3A10pt%20%7D%20%3C%2Fstyle%3E%3C%2Fdefs%3E%3Cg%20id%3D%22holder_174b1ede77f%22%3E%3Crect%20width%3D%2264%22%20height%3D%2264%22%20fill%3D%22%23777%22%3E%3C%2Frect%3E%3Cg%3E%3Ctext%20x%3D%2213%22%20y%3D%2236.5%22%3E64x64%3C%2Ftext%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E"
                                                    alt="64x64" style="width: 64px; height: 64px;" data-holder-rendered="true">
                                            </figure>
                                        </div>
                                        <div class="media-body">
                                            <div class="mt-0 mb-1">
                                                <strong class="card-title">
                                                    <%= link_to "#{hayComment.username_id}", profile_path(hayComment.username_id),class:"text-white" %>
                                                </strong><br />
                                                <p class="card-text">                            
                                                    <%= hayComment.comment %>
                                                </p>  
                                            </div>
                                        </div>
                                        <%if hayComment.username_id == current_user.username %>
                                            <nav class="level">
                                                <div class="level-left is-mobile d-flex justify-content-start">
                                                    <%= form_with(url: hayComment, method: "delete", class: "level-item p-1 pt-0 pl-2") do %>
                                                        <%= button_tag('',class:'icon' , data: {confirm: "Are you sure?"}) do %>
                                                            <svg width="1em" height="1em" class="bi bi-trash-fill p-0 m-0 pt-1" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                                                <path fill-rule="evenodd" d="M2.5 1a1 1 0 0 0-1 1v1a1 1 0 0 0 1 1H3v9a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V4h.5a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1H2.5zm3 4a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 .5-.5zM8 5a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7A.5.5 0 0 1 8 5zm3 .5a.5.5 0 0 0-1 0v7a.5.5 0 0 0 1 0v-7z"/>
                                                            </svg>
                                                        <% end %>
                                                    <% end %>                                                           
                                                </div>
                                            </nav>
                                        <%end%>
                                    </article>
                                </div>
                            </div>
                        <% end %>
                    </div>
                </div>
            </div>



        </div>

    <% end %>
</div>

<script>
    function mostrarformulario(id){
        let element = document.getElementById(id);
        let elementStyle = window.getComputedStyle(element);
        let elementDisplay = elementStyle.getPropertyValue('display');
        if (elementDisplay === 'none') {
            document.getElementById(id).style.display = "block";   
        }else{
            document.getElementById(id).style.display = "none";      
        }
    }
</script>
